library(ggplot2)
library(GGally)
library(car)
# create dataframe
wages <- read.csv(file = "~/GitHub/Stat525IEProject/datacpswages.dat.txt", header = FALSE, sep=" ")
# create dataframe
wages <- read.csv(file = "/GitHub/Stat525IEProject/datacpswages.dat.txt", header = FALSE, sep=" ")
# create dataframe
wages <- read.csv(file = "GitHub/Stat525IEProject/datacpswages.dat.txt", header = FALSE, sep=" ")
# create dataframe
wages <- read.csv(file = "GitHub/Stat525IEProject/data/cpswages.dat.txt", header = FALSE, sep=" ")
# create dataframe
wages <- read.csv(file = "/GitHub/Stat525IEProject/data/cpswages.dat.txt", header = FALSE, sep=" ")
# create dataframe
wages <- read.csv(file = "~/GitHub/Stat525IEProject/data/cpswages.dat.txt", header = FALSE, sep=" ")
library(ggplot2)
library(GGally)
library(car)
# create dataframe
wages <- read.csv(file = "~/GitHub/Stat525IEProject/data/cpswages.dat.txt", header = FALSE, sep=" ")
library(ggplot2)
library(GGally)
library(car)
# create dataframe
wages <- read.csv(file = "/GitHub/Stat525IEProject/data/cpswages.dat.txt", header = FALSE, sep=" ")
setwd("~/Documents")
# create dataframe
wages <- read.csv(file = "/GitHub/Stat525IEProject/data/cpswages.dat.txt", header = FALSE, sep=" ")
# create dataframe
wages <- read.csv(file = "~/GitHub/Stat525IEProject/data/cpswages.dat.txt", header = FALSE, sep=" ")
# create dataframe
wages <- read.csv(file = "~Document/GitHub/Stat525IEProject/data/cpswages.dat.txt", header = FALSE, sep=" ")
# create dataframe
wages <- read.csv(file = "~Documents/GitHub/Stat525IEProject/data/cpswages.dat.txt", header = FALSE, sep=" ")
# create dataframe
wages <- read.csv(file = "~/Home/Documents/GitHub/Stat525IEProject/data/cpswages.dat.txt", header = FALSE, sep=" ")
# create dataframe
wages <- read.csv(file = "/Home/Documents/GitHub/Stat525IEProject/data/cpswages.dat.txt", header = FALSE, sep=" ")
# create dataframe
wages <- read.csv(file = "Home/Documents/GitHub/Stat525IEProject/data/cpswages.dat.txt", header = FALSE, sep=" ")
# create dataframe
wages <- read.csv(file = "Documents/GitHub/Stat525IEProject/data/cpswages.dat.txt", header = FALSE, sep=" ")
# create dataframe
wages <- read.csv(file = "/GitHub/Stat525IEProject/data/cpswages.dat.txt", header = FALSE, sep=" ")
# create dataframe
wages <- read.csv(file = "\GitHub/Stat525IEProject/data/cpswages.dat.txt", header = FALSE, sep=" ")
# create dataframe
wages <- read.csv(file = "//GitHub/Stat525IEProject/data/cpswages.dat.txt", header = FALSE, sep=" ")
# create dataframe
wages <- read.csv(file = "/GitHub/Stat525IEProject/data/cpswages.dat.txt", header = FALSE, sep=" ")
setwd("~/Documents/GitHub/Stat525IEProject/data")
wages = read.csv('cpswages.dat.txt')
# create dataframe
wages <- read.csv(file = "~/Documents/GitHub/Stat525IEProject/data/cpswages.dat.txt", header = FALSE, sep=" ")
library(ggplot2)
library(GGally)
library(car)
# create dataframe
wages <- read.csv(file = "~/Documents/GitHub/Stat525IEProject/data/cpswages.dat.txt", header = FALSE, sep=" ")
names(wages) <- c("EDUCATION",	"SOUTH", "SEX", "EXPERIENCE", "UNION",  "WAGE", "AGE", "RACE", "OCCUPATION", "SECTOR", "MARR")
wages = wages[,c(1,2,3,4,5,7,8,9,10,11,6)]
# Set up factors
wages$SOUTH <- factor(wages$SOUTH, levels=c(0,1),
labels=c('North','South'))
wages$SEX <- factor(wages$SEX, levels=c(0,1),
labels=c('Male','Female'))
wages$UNION <- factor(wages$UNION, levels=c(0,1),
labels=c('Non-Unionized','Unionized'))
wages$RACE <- factor(wages$RACE, levels=c(1,2,3),
labels=c('Other','Hispanic', 'White'))
wages$OCCUPATION <- factor(wages$OCCUPATION, levels=c(1,2,3,4,5,6),
labels=c('Management','Sales','Clerical','Service','Professional','Other'))
wages$SECTOR <- factor(wages$SECTOR, levels=c(0,1,2),
labels=c('Other','Manufacturing','Construction'))
wages$MARR <- factor(wages$MARR, levels=c(0,1),
labels=c('Unmarried','Married'))
wages$ED_PLUS_EX <- wages$EDUCATION + wages$EXPERIENCE
women <- subset(wages,SEX=='Female')
men <- subset(wages,SEX=='Male')
library(ggplot2)
library(GGally)
library(car)
# create dataframe
wages <- read.csv(file = "~/Documents/GitHub/Stat525IEProject/data/cpswages.dat.txt", header = FALSE, sep=" ")
names(wages) <- c("EDUCATION",	"SOUTH", "SEX", "EXPERIENCE", "UNION",  "WAGE", "AGE", "RACE", "OCCUPATION", "SECTOR", "MARR")
wages = wages[,c(1,2,3,4,5,7,8,9,10,11,6)]
# Set up factors
wages$SOUTH <- factor(wages$SOUTH, levels=c(0,1),
labels=c('North','South'))
wages$SEX <- factor(wages$SEX, levels=c(0,1),
labels=c('Male','Female'))
wages$UNION <- factor(wages$UNION, levels=c(0,1),
labels=c('Non-Unionized','Unionized'))
wages$RACE <- factor(wages$RACE, levels=c(1,2,3),
labels=c('Other','Hispanic', 'White'))
wages$OCCUPATION <- factor(wages$OCCUPATION, levels=c(1,2,3,4,5,6),
labels=c('Management','Sales','Clerical','Service','Professional','Other'))
wages$SECTOR <- factor(wages$SECTOR, levels=c(0,1,2),
labels=c('Other','Manufacturing','Construction'))
wages$MARR <- factor(wages$MARR, levels=c(0,1),
labels=c('Unmarried','Married'))
wages$ED_PLUS_EX <- wages$EDUCATION + wages$EXPERIENCE
women <- subset(wages,SEX=='Female')
men <- subset(wages,SEX=='Male')
ggpairs(wages, columns = c("EDUCATION", "EXPERIENCE", "AGE", "SEX" ,"WAGE"), aes(colour=SEX))
#We guess that education and sex will have to do something with wage
p = ggplot(aes(x=EDUCATION, y=WAGE),data=wages)
#p + geom_point(data=wages, aes(color=SEX)) #See that a lot of data is clumped together
p + geom_point(data=wages, aes(color=SEX)) + geom_smooth(method='lm', aes(color=SEX), data=wages)
#see that the slopes are very close to identical but have different intercept so there is wage gap
mod = lm(WAGE~EDUCATION, data=wages)
mod1 = lm(WAGE~EDUCATION + SEX, data=wages)
summary(mod)
summary(mod1) #see that we have low r^2 value and nothing is interesting lets try doing added variable plots
p2 = ggplot(aes(x=AGE, y=EXPERIENCE), data=wages)
p2 + geom_point(aes(color=SEX), data=wages) + geom_smooth(method="lm", aes(color=SEX), data=wages)
mod2 = lm(EXPERIENCE~AGE, data=wages)
wages$resid1 = resid(mod1)
p2 = ggplot(aes(y=resid1), data=wages)
p2 + geom_point(aes(x=resid(lm(EXPERIENCE~EDUCATION + SEX, data=wages)))) + ggtitle("Added Variable Plot for EXPERIENCE") + xlab('Residual of EXPERIENCE ~ EDUCATION + SEX') + ylab('Residual of Mod1')
#has good linear model except for that one outlier
mod3 = lm(WAGE~EDUCATION + SEX + EXPERIENCE, data=wages)
avPlots(mod3)
summary(mod3); summary(mod1)
wages$resid3 = resid(mod3)
p3 = ggplot(aes(y=resid3), data=wages)
p3 + geom_point(aes(x=resid(lm(AGE~EDUCATION + SEX + EXPERIENCE, data=wages)))) + ggtitle('Added Variable Plot for AGE') + xlab('Residual of AGE~EDUCATION + SEX + EXPERIENCE') + ylab('Residual of Mod2')
ggpairs ( wages, columns = c("EDUCATION","EXPERIENCE","AGE","ED_PLUS_EX", "WAGE") )
wages.fit1 = fitted(mod1)
wages.resid1 = resid(mod1)
wages.fit3 = fitted(mod3)
wages.resid3 = resid(mod3)
p4 = ggplot(aes(x=wages.fit1, y=wages.resid1), data=wages)
p4 + geom_point()
p5 = ggplot(aes(x=wages.fit3, y=wages.resid3), data=wages)
p5 + geom_point()
wages$EXPERIENCE = wages$EXPERIENCE + 1
coef(powerTransform(wages[,c("EDUCATION","EXPERIENCE")]), round=TRUE)
wages$tranEXPERIENCE = wages$EXPERIENCE^(1/2)
tranMod3 = lm(WAGE~tranEXPERIENCE + EDUCATION + SEX, data=wages)
summary(tranMod2);summary(mod2)
wages$tranEXPERIENCE = wages$EXPERIENCE^(1/2)
tranMod3 = lm(WAGE~tranEXPERIENCE + EDUCATION + SEX, data=wages)
summary(tranMod3);summary(mod3)
library(ggplot2)
library(GGally)
library(car)
# create dataframe
wages <- read.csv(file = "~/Documents/GitHub/Stat525IEProject/data/cpswages.dat.txt", header = FALSE, sep=" ")
names(wages) <- c("EDUCATION",	"SOUTH", "SEX", "EXPERIENCE", "UNION",  "WAGE", "AGE", "RACE", "OCCUPATION", "SECTOR", "MARR")
wages = wages[,c(1,2,3,4,5,7,8,9,10,11,6)]
# Set up factors
wages$SOUTH <- factor(wages$SOUTH, levels=c(0,1),
labels=c('North','South'))
wages$SEX <- factor(wages$SEX, levels=c(0,1),
labels=c('Male','Female'))
wages$UNION <- factor(wages$UNION, levels=c(0,1),
labels=c('Non-Unionized','Unionized'))
wages$RACE <- factor(wages$RACE, levels=c(1,2,3),
labels=c('Other','Hispanic', 'White'))
wages$OCCUPATION <- factor(wages$OCCUPATION, levels=c(1,2,3,4,5,6),
labels=c('Management','Sales','Clerical','Service','Professional','Other'))
wages$SECTOR <- factor(wages$SECTOR, levels=c(0,1,2),
labels=c('Other','Manufacturing','Construction'))
wages$MARR <- factor(wages$MARR, levels=c(0,1),
labels=c('Unmarried','Married'))
wages$ED_PLUS_EX <- wages$EDUCATION + wages$EXPERIENCE
women <- subset(wages,SEX=='Female')
men <- subset(wages,SEX=='Male')
ggpairs(wages, columns = c("EDUCATION", "EXPERIENCE", "AGE", "SEX" ,"WAGE"), aes(colour=SEX))
#We guess that education and sex will have to do something with wage
p = ggplot(aes(x=EDUCATION, y=WAGE),data=wages)
#p + geom_point(data=wages, aes(color=SEX)) #See that a lot of data is clumped together
p + geom_point(data=wages, aes(color=SEX)) + geom_smooth(method='lm', aes(color=SEX), data=wages)
#see that the slopes are very close to identical but have different intercept so there is wage gap
mod = lm(WAGE~EDUCATION, data=wages)
mod1 = lm(WAGE~EDUCATION + SEX, data=wages)
summary(mod)
summary(mod1) #see that we have low r^2 value and nothing is interesting lets try doing added variable plots
p2 = ggplot(aes(x=AGE, y=EXPERIENCE), data=wages)
p2 + geom_point(aes(color=SEX), data=wages) + geom_smooth(method="lm", aes(color=SEX), data=wages)
mod2 = lm(EXPERIENCE~AGE, data=wages)
wages$resid1 = resid(mod1)
p2 = ggplot(aes(y=resid1), data=wages)
p2 + geom_point(aes(x=resid(lm(EXPERIENCE~EDUCATION + SEX, data=wages)))) + ggtitle("Added Variable Plot for EXPERIENCE") + xlab('Residual of EXPERIENCE ~ EDUCATION + SEX') + ylab('Residual of Mod1')
#has good linear model except for that one outlier
mod3 = lm(WAGE~EDUCATION + SEX + EXPERIENCE, data=wages)
avPlots(mod3)
summary(mod3); summary(mod1)
wages$resid3 = resid(mod3)
p3 = ggplot(aes(y=resid3), data=wages)
p3 + geom_point(aes(x=resid(lm(AGE~EDUCATION + SEX + EXPERIENCE, data=wages)))) + ggtitle('Added Variable Plot for AGE') + xlab('Residual of AGE~EDUCATION + SEX + EXPERIENCE') + ylab('Residual of Mod2')
ggpairs ( wages, columns = c("EDUCATION","EXPERIENCE","AGE","ED_PLUS_EX", "WAGE") )
wages.fit1 = fitted(mod1)
wages.resid1 = resid(mod1)
wages.fit3 = fitted(mod3)
wages.resid3 = resid(mod3)
p4 = ggplot(aes(x=wages.fit1, y=wages.resid1), data=wages)
p4 + geom_point()
p5 = ggplot(aes(x=wages.fit3, y=wages.resid3), data=wages)
p5 + geom_point()
wages$EXPERIENCE = wages$EXPERIENCE + 1
coef(powerTransform(wages[,c("EDUCATION","EXPERIENCE")]), round=TRUE)
wages$tranEXPERIENCE = wages$EXPERIENCE^(1/2)
tranMod3 = lm(WAGE~tranEXPERIENCE + EDUCATION + SEX, data=wages)
summary(tranMod3);summary(mod3)
coef(powerTransform(WAGE~tranEXPERIENCE + EDUCATION + SEX, data=wages), round=TRUE)
tranMod3.1 = lm(log(WAGE)~tranEXPERIENCE + EDUCATION + SEX, data=wages)
summary(tranMod2.1);summary(tranMod2)
library(ggplot2)
library(GGally)
library(car)
# create dataframe
wages <- read.csv(file = "~/Documents/GitHub/Stat525IEProject/data/cpswages.dat.txt", header = FALSE, sep=" ")
names(wages) <- c("EDUCATION",	"SOUTH", "SEX", "EXPERIENCE", "UNION",  "WAGE", "AGE", "RACE", "OCCUPATION", "SECTOR", "MARR")
wages = wages[,c(1,2,3,4,5,7,8,9,10,11,6)]
# Set up factors
wages$SOUTH <- factor(wages$SOUTH, levels=c(0,1),
labels=c('North','South'))
wages$SEX <- factor(wages$SEX, levels=c(0,1),
labels=c('Male','Female'))
wages$UNION <- factor(wages$UNION, levels=c(0,1),
labels=c('Non-Unionized','Unionized'))
wages$RACE <- factor(wages$RACE, levels=c(1,2,3),
labels=c('Other','Hispanic', 'White'))
wages$OCCUPATION <- factor(wages$OCCUPATION, levels=c(1,2,3,4,5,6),
labels=c('Management','Sales','Clerical','Service','Professional','Other'))
wages$SECTOR <- factor(wages$SECTOR, levels=c(0,1,2),
labels=c('Other','Manufacturing','Construction'))
wages$MARR <- factor(wages$MARR, levels=c(0,1),
labels=c('Unmarried','Married'))
wages$ED_PLUS_EX <- wages$EDUCATION + wages$EXPERIENCE
women <- subset(wages,SEX=='Female')
men <- subset(wages,SEX=='Male')
ggpairs(wages, columns = c("EDUCATION", "EXPERIENCE", "AGE", "SEX" ,"WAGE"), aes(colour=SEX))
#We guess that education and sex will have to do something with wage
p = ggplot(aes(x=EDUCATION, y=WAGE),data=wages)
#p + geom_point(data=wages, aes(color=SEX)) #See that a lot of data is clumped together
p + geom_point(data=wages, aes(color=SEX)) + geom_smooth(method='lm', aes(color=SEX), data=wages)
#see that the slopes are very close to identical but have different intercept so there is wage gap
mod = lm(WAGE~EDUCATION, data=wages)
mod1 = lm(WAGE~EDUCATION + SEX, data=wages)
summary(mod)
summary(mod1) #see that we have low r^2 value and nothing is interesting lets try doing added variable plots
p2 = ggplot(aes(x=AGE, y=EXPERIENCE), data=wages)
p2 + geom_point(aes(color=SEX), data=wages) + geom_smooth(method="lm", aes(color=SEX), data=wages)
mod2 = lm(EXPERIENCE~AGE, data=wages)
wages$resid1 = resid(mod1)
p2 = ggplot(aes(y=resid1), data=wages)
p2 + geom_point(aes(x=resid(lm(EXPERIENCE~EDUCATION + SEX, data=wages)))) + ggtitle("Added Variable Plot for EXPERIENCE") + xlab('Residual of EXPERIENCE ~ EDUCATION + SEX') + ylab('Residual of Mod1')
#has good linear model except for that one outlier
mod3 = lm(WAGE~EDUCATION + SEX + EXPERIENCE, data=wages)
avPlots(mod3)
summary(mod3); summary(mod1)
wages$resid3 = resid(mod3)
p3 = ggplot(aes(y=resid3), data=wages)
p3 + geom_point(aes(x=resid(lm(AGE~EDUCATION + SEX + EXPERIENCE, data=wages)))) + ggtitle('Added Variable Plot for AGE') + xlab('Residual of AGE~EDUCATION + SEX + EXPERIENCE') + ylab('Residual of Mod2')
ggpairs ( wages, columns = c("EDUCATION","EXPERIENCE","AGE","ED_PLUS_EX", "WAGE") )
wages.fit1 = fitted(mod1)
wages.resid1 = resid(mod1)
wages.fit3 = fitted(mod3)
wages.resid3 = resid(mod3)
p4 = ggplot(aes(x=wages.fit1, y=wages.resid1), data=wages)
p4 + geom_point()
p5 = ggplot(aes(x=wages.fit3, y=wages.resid3), data=wages)
p5 + geom_point()
wages$EXPERIENCE = wages$EXPERIENCE + 1
coef(powerTransform(wages[,c("EDUCATION","EXPERIENCE")]), round=TRUE)
wages$tranEXPERIENCE = wages$EXPERIENCE^(1/2)
tranMod3 = lm(WAGE~tranEXPERIENCE + EDUCATION + SEX, data=wages)
summary(tranMod3);summary(mod3)
coef(powerTransform(WAGE~tranEXPERIENCE + EDUCATION + SEX, data=wages), round=TRUE)
tranMod3.1 = lm(log(WAGE)~tranEXPERIENCE + EDUCATION + SEX, data=wages)
summary(tranMod3.1);summary(tranMod3)
mod4 = lm(log(WAGE)~tranEXPERIENCE + EDUCATION + SEX + OCCUPATION, data=wages)
summary(mod4); summary(tranMod3.1)
wages.resid4 = resid(mod4)
wages.fit4 = fitted(mod4)
p6 = ggplot(aes(x=wages.fit4, y=wages.resid4), data=wages)
p6 + geom_point() + facet_wrap(~wages$OCCUPATION)
