library(ggplot2)
library(GGally)
# create dataframe
wages <- read.csv(file = "../data/cpswages.dat.txt", header = FALSE, sep=" ")
names(wages) <- c("EDUCATION",	"SOUTH", "SEX", "EXPERIENCE", "UNION",  "WAGE", "AGE", "RACE", "OCCUPATION", "SECTOR", "MARR")
wages = wages[,c(1,2,3,4,5,7,8,9,10,11,6)]
# Set up factors
wages$SOUTH <- factor(wages$SOUTH, levels=c(0,1),
labels=c('North','South'))
wages$SEX <- factor(wages$SEX, levels=c(0,1),
labels=c('Male','Female'))
wages$UNION <- factor(wages$UNION, levels=c(0,1),
labels=c('Non-Unionized','Unionized'))
wages$RACE <- factor(wages$RACE, levels=c(1,2,3),
labels=c('Other','Hispanic', 'White'))
wages$OCCUPATION <- factor(wages$OCCUPATION, levels=c(1,2,3,4,5,6),
labels=c('Management','Sales','Clerical','Service','Professional','Other'))
wages$SECTOR <- factor(wages$SECTOR, levels=c(0,1,2),
labels=c('Other','Manufacturing','Construction'))
wages$MARR <- factor(wages$MARR, levels=c(0,1),
labels=c('Unmarried','Married'))
wages$MANUFACTURING <- 1*(wages$SECTOR == 'Manufacturing')
wages$CONSTRUCTION <- 1*(wages$SECTOR == 'Construction')
wages$MANAGEMENT <- 1*(wages$OCCUPATION == 'Management')
wages$SALES <- 1*(wages$OCCUPATION == 'Sales')
wages$CLERICAL <- 1*(wages$OCCUPATION == 'Clerical')
wages$SERVICE <- 1*(wages$OCCUPATION == 'Service')
wages$PROFESSIONAL <- 1*(wages$OCCUPATION == 'Professional')
wages$WHITE <- 1*(wages$RACE == 'White')
wages$HISPANIC <- 1*(wages$RACE == 'Hispanic')
wages$ED_PLUS_EX <- wages$EDUCATION + wages$EXPERIENCE
women <- subset(wages,SEX=='Female')
men <- subset(wages,SEX=='Male')
p <- ggplot( wages, aes ( x = SEX, y = WAGE) )
p + geom_boxplot() + ggtitle("Boxplot of Wage vs Sex")
p <- ggplot( wages, aes ( x = SEX, y = WAGE) )
p + geom_boxplot() + ggtitle("Boxplot of Wage vs Sex")
p <- ggplot( wages, aes ( x = SEX, y = WAGE) )
p + geom_boxplot() + ggtitle("Boxplot of Wage vs Sex")
p <- ggplot( wages, aes ( x = SEX, y = WAGE) )
p + geom_boxplot() + ggtitle("Boxplot of Wage vs Sex")
install.packages("captioner")
library(captioner)
library(ggplot2)
library(GGally)
library(captioner)
figs <- captioner(prefix="Figure")
# create dataframe
wages <- read.csv(file = "../data/cpswages.dat.txt", header = FALSE, sep=" ")
names(wages) <- c("EDUCATION",	"SOUTH", "SEX", "EXPERIENCE", "UNION",  "WAGE", "AGE", "RACE", "OCCUPATION", "SECTOR", "MARR")
wages = wages[,c(1,2,3,4,5,7,8,9,10,11,6)]
# Set up factors
wages$SOUTH <- factor(wages$SOUTH, levels=c(0,1),
labels=c('North','South'))
wages$SEX <- factor(wages$SEX, levels=c(0,1),
labels=c('Male','Female'))
wages$UNION <- factor(wages$UNION, levels=c(0,1),
labels=c('Non-Unionized','Unionized'))
wages$RACE <- factor(wages$RACE, levels=c(1,2,3),
labels=c('Other','Hispanic', 'White'))
wages$OCCUPATION <- factor(wages$OCCUPATION, levels=c(1,2,3,4,5,6),
labels=c('Management','Sales','Clerical','Service','Professional','Other'))
wages$SECTOR <- factor(wages$SECTOR, levels=c(0,1,2),
labels=c('Other','Manufacturing','Construction'))
wages$MARR <- factor(wages$MARR, levels=c(0,1),
labels=c('Unmarried','Married'))
wages$MANUFACTURING <- 1*(wages$SECTOR == 'Manufacturing')
wages$CONSTRUCTION <- 1*(wages$SECTOR == 'Construction')
wages$MANAGEMENT <- 1*(wages$OCCUPATION == 'Management')
wages$SALES <- 1*(wages$OCCUPATION == 'Sales')
wages$CLERICAL <- 1*(wages$OCCUPATION == 'Clerical')
wages$SERVICE <- 1*(wages$OCCUPATION == 'Service')
wages$PROFESSIONAL <- 1*(wages$OCCUPATION == 'Professional')
wages$WHITE <- 1*(wages$RACE == 'White')
wages$HISPANIC <- 1*(wages$RACE == 'Hispanic')
wages$ED_PLUS_EX <- wages$EDUCATION + wages$EXPERIENCE
women <- subset(wages,SEX=='Female')
men <- subset(wages,SEX=='Male')
p <- ggplot( wages, aes ( x = SEX, y = WAGE) )
p + geom_boxplot() + ggtitle("Boxplot of Wage vs Sex")
figs(name="LenFreq1","Length frequency of Ruffe captured in 1992.")
p <- ggplot( wages, aes ( x = SEX, y = WAGE) )
p + geom_boxplot() + ggtitle("Boxplot of Wage vs Sex")
figs(name="LenFreq1","Length frequency of Ruffe captured in 1992.")
figs("LenFreq1",display="cite")
p <- ggplot( wages, aes ( x = SEX, y = WAGE) )
p + geom_boxplot() + ggtitle("Boxplot of Wage vs Sex")
setwd("~/GitHub/Stat525IEProject")
library(ggplot2)
library(GGally)
# create dataframe
wages <- read.csv(file = "../data/cpswages.dat.txt", header = FALSE, sep=" ")
library(ggplot2)
library(GGally)
# create dataframe
wages <- read.csv(file = "/data/cpswages.dat.txt", header = FALSE, sep=" ")
setwd("~/GitHub/Stat525IEProject/data")
library(ggplot2)
library(GGally)
# create dataframe
wages <- read.csv(file = "cpswages.dat.txt", header = FALSE, sep=" ")
names(wages) <- c("EDUCATION",	"SOUTH", "SEX", "EXPERIENCE", "UNION",  "WAGE", "AGE", "RACE", "OCCUPATION", "SECTOR", "MARR")
wages = wages[,c(1,2,3,4,5,7,8,9,10,11,6)]
# Set up factors
wages$SOUTH <- factor(wages$SOUTH, levels=c(0,1),
labels=c('North','South'))
wages$SEX <- factor(wages$SEX, levels=c(0,1),
labels=c('Male','Female'))
wages$UNION <- factor(wages$UNION, levels=c(0,1),
labels=c('Non-Unionized','Unionized'))
wages$RACE <- factor(wages$RACE, levels=c(1,2,3),
labels=c('Other','Hispanic', 'White'))
wages$OCCUPATION <- factor(wages$OCCUPATION, levels=c(1,2,3,4,5,6),
labels=c('Management','Sales','Clerical','Service','Professional','Other'))
wages$SECTOR <- factor(wages$SECTOR, levels=c(0,1,2),
labels=c('Other','Manufacturing','Construction'))
wages$MARR <- factor(wages$MARR, levels=c(0,1),
labels=c('Unmarried','Married'))
wages$MANUFACTURING <- 1*(wages$SECTOR == 'Manufacturing')
wages$CONSTRUCTION <- 1*(wages$SECTOR == 'Construction')
wages$MANAGEMENT <- 1*(wages$OCCUPATION == 'Management')
wages$SALES <- 1*(wages$OCCUPATION == 'Sales')
wages$CLERICAL <- 1*(wages$OCCUPATION == 'Clerical')
wages$SERVICE <- 1*(wages$OCCUPATION == 'Service')
wages$PROFESSIONAL <- 1*(wages$OCCUPATION == 'Professional')
wages$WHITE <- 1*(wages$RACE == 'White')
wages$HISPANIC <- 1*(wages$RACE == 'Hispanic')
wages$ED_PLUS_EX <- wages$EDUCATION + wages$EXPERIENCE
women <- subset(wages,SEX=='Female')
men <- subset(wages,SEX=='Male')
#We guess that education and sex will have to do something with wage
p = ggplot(aes(x=EDUCATION, y=WAGE)data=wages)
#We guess that education and sex will have to do something with wage
p = ggplot(aes(x=EDUCATION, y=WAGE),data=wages)
p + geom_point(color=SEX)
p + geom_point(color=SEX, data=wages)
p + geom_point(color=SEX, data=wages)
head(wages)
p + geom_point(data=wages, aes(color=SEX))
p + geom_point(data=wages, aes(color=SEX)) + geom_jitter(0.50)
p + geom_point(data=wages, aes(color=SEX)) + geom_jitter(aes(0.50))
p + geom_point(data=wages, aes(color=SEX))
p + geom_point(data=wages, aes(color=SEX)) + geom_smooth(method='lm')
p + geom_point(data=wages, aes(color=SEX)) + geom_smooth(method='lm', color='SEX')
p + geom_point(data=wages, aes(color=SEX)) + geom_smooth(method='lm', aes(color=SEX), data=wages)
mod = lm(WAGES~EDUCATION, data=wages)
mod = lm(WAGE~EDUCATION, data=wages)
mod = lm(WAGE~EDUCATION + SEX, data=wages)
mod1 = lm(WAGE~EDUCATION + SEX, data=wages)
summary(mod1)
p2 = ggplot(aes(y=resid1), data=wages)
head(wages)
p2 + geom_point(aes(x=resid(lm(EXPERIENCE~EDUCATION + SEX, data=wages))))
wages$resid1 = resid(mod1)
p2 = ggplot(aes(y=resid1), data=wages)
p2 + geom_point(aes(x=resid(lm(EXPERIENCE~EDUCATION + SEX, data=wages))))
p2 + geom_point(aes(x=resid(lm(AGE~EDUCATION + SEX, data=wages))))
p2 + geom_point(aes(x=resid(lm(AGE~EDUCATION + SEX, data=wages))))
head(wages)
p2 + geom_point(aes(x=SOUTH(lm(EXPERIENCE~EDUCATION + SEX, data=wages))))
p2 + geom_point(aes(x=resid(lm(SOUTH~EDUCATION + SEX, data=wages))))
p2 + geom_point(aes(x=resid(lm(SOUTH~EDUCATION + SEX, data=wages))))
p2 + geom_point(aes(x=resid(lm(SECTOR~EDUCATION + SEX, data=wages))))
p2 + geom_point(aes(x=resid(glm(SECTOR~EDUCATION + SEX, data=wages))))
library(car)
p2 + geom_point(aes(x=resid(lm(AGE~EDUCATION + SEX, data=wages)))) #also a good linear model except for one outlier
head(wages)
#lets check if transformation of our data makes it any better
powerTransform(cbind("EDUCATION","EXPERIENCE","AGE")~1)
mod2 = lm(WAGES~EDUCATION + SEX + EXPERIENCE, data=wages)
mod2 = lm(WAGE~EDUCATION + SEX + EXPERIENCE, data=wages)
summary(mod2); summary(mod1)
p3 = ggplot(aes(y=resid2), data=wages)
p3 + geom_point(aes(x=resid(lm(AGE~EDUCATION + SEX + EXPERIENCE, data=wages))))
wages$resid2 = resid(mod2)
p3 = ggplot(aes(y=resid2), data=wages)
p3 + geom_point(aes(x=resid(lm(AGE~EDUCATION + SEX + EXPERIENCE, data=wages))))
